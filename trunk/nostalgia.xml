<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="hello world example" />
  <Content type="html">
  <![CDATA[
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<body>
<script>

function run() {
  var startDate = {year: 2013, month: 3, date : 15,
                   hour : 0, minute: 0, second: 0};
  var endDate = {year: 2013, month: 3, date : 16,
                 hour : 0, minute: 0, second: 0};

  var calendars = '@viewer'

  google.calendar.read.getEvents(eventCallback, calendars, startDate, endDate);
}

function eventCallback(response) {
  var out = '';
  for (var i = 0; i < response.length; ++i) {
    if ('error' in response[i]) {
      out += 'Can\'t load calendar for ' + response[i].email + '\n';
      continue;
    }

    out += '<b>One Year Ago</b><p/>'

    var events = response[i]['events'];
    for(var j = 0; j < events.length; ++j) {
      var e = events[j];
      if ('title' in e) {
		out += '<a onclick="google.calendar.showEvent(\'' + e.id + '\')">' + e.title + '</a><p/>'
      }
    }
  }
  alert(out);
  document.write(out);
}
gadgets.util.registerOnLoadHandler(run);
</script>
</body>
</html>
  ]]></Content>
</Module>
